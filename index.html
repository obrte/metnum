<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Metodos Numericos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- bootstrap -->
    <link href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons' rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.min.css" rel="stylesheet">
    <!-- <script src="./js/jquery-1.11.3.js"></script> -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

</head>

<body>
    <div id="app">
        <v-app id="inspire" dark>
            <v-navigation-drawer clipped fixed v-model="drawer" app>
                <v-list dense>
                    <v-list-tile @click="menu = 'biseccion'">
                        <v-list-tile-action>
                            <v-icon large color="deep-orange" v-if="menu == 'biseccion'">forward</v-icon>
                        </v-list-tile-action>
                        <v-list-tile-content>
                            <v-list-tile-title>Bisección</v-list-tile-title>
                        </v-list-tile-content>
                    </v-list-tile>
                    <v-list-tile @click="menu = 'newton'">
                        <v-list-tile-action>
                            <v-icon large color="deep-orange" v-if="menu == 'newton'">forward</v-icon>
                        </v-list-tile-action>
                        <v-list-tile-content>
                            <v-list-tile-title>Newton</v-list-tile-title>
                        </v-list-tile-content>
                    </v-list-tile>
                    <v-list-tile @click="menu = 'secante'">
                        <v-list-tile-action>
                            <v-icon large color="deep-orange" v-if="menu == 'secante'">forward</v-icon>
                        </v-list-tile-action>
                        <v-list-tile-content>
                            <v-list-tile-title>Secante</v-list-tile-title>
                        </v-list-tile-content>
                    </v-list-tile>
                    <v-list-tile @click="menu = 'cambio'">
                        <v-list-tile-action>
                            <v-icon large color="deep-orange" v-if="menu == 'cambio'">forward</v-icon>
                        </v-list-tile-action>
                        <v-list-tile-content>
                            <v-list-tile-title>Cambio de variable</v-list-tile-title>
                        </v-list-tile-content>
                    </v-list-tile>
                </v-list>
            </v-navigation-drawer>
            <v-toolbar app fixed clipped-left>
                <v-toolbar-side-icon @click.stop="drawer = !drawer"></v-toolbar-side-icon>
                <v-toolbar-title>Menu</v-toolbar-title>
                <v-divider class="mx-3 pr-5" inset vertical></v-divider>
                <v-flex xs6 sm2 md2 pl-5 ml-5>
                    <v-toolbar-title>Metodos Númericos</v-toolbar-title>
                </v-flex>
                <v-toolbar-title v-text="metodo"></v-toolbar-title>
                </v-flex>

            </v-toolbar>
            <v-content>
                <v-layout row wrap>
                    <!-- Funcion -->
                    <v-flex xs12 sm2 md2 pl-3 pt-4 v-if="menu != ''">
                        <v-text-field label="f(x)=" outline v-model="funDeXs"></v-text-field>
                    </v-flex>
                    <!-- Biseccion -->
                    <v-flex xs12 sm1 md1 pl-3 pt-4 v-if="menu == 'biseccion'">
                        <v-text-field label="Xi=" outline v-model="Xi"></v-text-field>
                    </v-flex>
                    <v-flex xs12 sm1 md1 pl-3 pt-4 v-if="menu == 'biseccion'">
                        <v-text-field label="Xf=" outline v-model="Xf"></v-text-field>
                    </v-flex>
                    <v-flex xs12 sm2 md2 pt-2 pl-3 v-if="menu == 'biseccion'">
                        <v-btn fab dark large color="light-green" @click="biseccion">
                            <v-icon dark>subdirectory_arrow_left</v-icon>
                        </v-btn>
                    </v-flex>
                    <!-- Newton -->
                    <v-flex xs12 sm2 md2 pl-3 pt-4 v-if="menu == 'newton'">
                        <v-text-field label="f'(x)=" outline v-model="deriF"></v-text-field>
                    </v-flex>
                    <v-flex xs12 sm1 md1 pl-3 pt-4 v-if="menu == 'newton'">
                        <v-text-field label="Xn =" outline v-model="Xn"></v-text-field>
                    </v-flex>
                    <v-flex xs12 sm1 md1 pt-2 pl-3 v-if="menu == 'newton'">
                        <v-btn fab dark large color="light-green" @click="newton">
                            <v-icon dark>subdirectory_arrow_left</v-icon>
                        </v-btn>
                    </v-flex>
                    <!-- Secante -->
                    <v-flex xs12 sm1 md1 pl-3 pt-4 v-if="menu == 'secante'">
                        <v-text-field label="X0=" outline v-model="Xi"></v-text-field>
                    </v-flex>
                    <v-flex xs12 sm1 md1 pl-3 pt-4 v-if="menu == 'secante'">
                        <v-text-field label="X1=" outline v-model="Xf"></v-text-field>
                    </v-flex>
                    <v-flex xs12 sm2 md2 pt-2 pl-3 v-if="menu == 'secante'">
                        <v-btn fab dark large color="light-green" @click="secante">
                            <v-icon dark>subdirectory_arrow_left</v-icon>
                        </v-btn>
                    </v-flex>
                    <!-- Limpiar -->
                    <v-flex xs12 sm1 md1 pt-2 pl-3 v-if="menu != ''">
                        <v-btn fab dark large color="red" @click="limpiar">
                            <v-icon dark>delete_forever</v-icon>
                        </v-btn>
                    </v-flex>

                </v-layout>
                <!-- Tabla Biseccion -->
                <template v-if="menu == 'biseccion'">
                    <v-data-table :headers="headersBise" :items="evaluacion" hide-actions class="elevation-1">
                        <template slot="items" slot-scope="props">
                            <td>{{ props.item.numero }}</td>
                            <td class="text-xs-left">{{ props.item.Xi }}</td>
                            <td class="text-xs-left">{{ props.item.Xf }}</td>
                            <td class="text-xs-left">{{ props.item.Xm }}</td>
                            <td class="text-xs-left">{{ props.item.fXi }}</td>
                            <td class="text-xs-left">{{ props.item.fXm }}</td>
                            <td class="text-xs-left">{{ props.item.fXifXm }}</td>
                            <td class="text-xs-left">{{ props.item.Ea }}</td>
                        </template>
                        <template slot="no-data">
                            <v-alert :value="true" :color="Colorerror" icon="warning">
                                Verifique los datos de entrada y presione
                                <v-btn color="light-green" fab small dark>
                                    <v-icon>subdirectory_arrow_left</v-icon>
                                </v-btn>
                            </v-alert>
                        </template>
                    </v-data-table>
                </template>
                <!-- Tabla Newton -->
                <template v-if="menu == 'newton'">
                    <v-data-table :headers="headersNewton" :items="evaluacion" hide-actions class="elevation-1">
                        <template slot="items" slot-scope="props">
                            <td>{{ props.item.numero }}</td>
                            <td class="text-xs-left">{{ props.item.X }}</td>
                            <td class="text-xs-left">{{ props.item.fX }}</td>
                            <td class="text-xs-left">{{ props.item.fderiX }}</td>
                            <td class="text-xs-left">{{ props.item.Ea }}</td>
                        </template>
                        <template slot="no-data">
                            <v-alert :value="true" :color="Colorerror" icon="warning">
                                Verifique los datos de entrada y presione
                                <v-btn color="light-green" fab small dark>
                                    <v-icon>subdirectory_arrow_left</v-icon>
                                </v-btn>
                            </v-alert>
                        </template>
                    </v-data-table>
                </template>
                <!-- Tabla Secante -->
                <template v-if="menu == 'secante'">
                    <v-data-table :headers="headersSecante" :items="evaluacion" hide-actions class="elevation-1">
                        <template slot="items" slot-scope="props">
                            <td>{{ props.item.numero }}</td>
                            <td class="text-xs-left">{{ props.item.Xa }}</td>
                            <td class="text-xs-left">{{ props.item.Xb }}</td>
                            <td class="text-xs-left">{{ props.item.fXa }}</td>
                            <td class="text-xs-left">{{ props.item.fXb }}</td>
                            <td class="text-xs-left">{{ props.item.Xc }}</td>
                            <td class="text-xs-left">{{ props.item.Ea }}</td>
                        </template>
                        <template slot="no-data">
                            <v-alert :value="true" :color="Colorerror" icon="warning">
                                Verifique los datos de entrada y presione
                                <v-btn color="light-green" fab small dark>
                                    <v-icon>subdirectory_arrow_left</v-icon>
                                </v-btn>
                            </v-alert>
                        </template>
                    </v-data-table>
                </template>

            </v-content>
            <v-footer app fixed>
                <span>&copy; 2018 Bracamonte</span>
            </v-footer>
        </v-app>
    </div>

    <script src="./js/math.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.js"></script>
    <script>
        var app = new Vue({
            el: '#app',
            data: () => ({
                drawer: true,
                Colorerror: 'info',
                metodo: '',
                funDeXs: '',
                menu: '',
                Xi: '',
                Xf: '',
                deriF: '',
                Xn: '',
                eR: '',
                evaluacion: [],
                headersBise: [{
                        text: '#',
                        align: 'left',
                        sortable: false,
                        value: 'numero'
                    },
                    {
                        text: 'Xi',
                        sortable: false,
                        value: 'Xi'
                    },
                    {
                        text: 'Xf',
                        sortable: false,
                        value: 'Xf'
                    },
                    {
                        text: 'Xm',
                        sortable: false,
                        value: 'Xm'
                    },
                    {
                        text: 'f(Xi)',
                        sortable: false,
                        value: 'fXi'
                    },
                    {
                        text: 'f(Xm)',
                        sortable: false,
                        value: 'fXm'
                    },
                    {
                        text: 'f(Xi)*f(Xm)',
                        sortable: false,
                        value: 'fXifXm'
                    },
                    {
                        text: 'Ea',
                        sortable: false,
                        value: 'Ea'
                    }
                ],
                headersNewton: [{
                        text: '#',
                        align: 'left',
                        sortable: false,
                        value: 'numero'
                    },
                    {
                        text: 'X',
                        sortable: false,
                        value: 'X'
                    },
                    {
                        text: 'f(X)',
                        sortable: false,
                        value: 'fX'
                    },
                    {
                        text: 'f´(X)',
                        sortable: false,
                        value: 'fderiX'
                    },
                    {
                        text: 'Ea',
                        sortable: false,
                        value: 'Ea'
                    }
                ],
                headersSecante: [{
                        text: '#',
                        align: 'left',
                        sortable: false,
                        value: 'numero'
                    },
                    {
                        text: 'Xn-1',
                        sortable: false,
                        value: 'Xa'
                    },
                    {
                        text: 'Xn',
                        sortable: false,
                        value: 'Xb'
                    },
                    {
                        text: 'f(Xn-1)',
                        sortable: false,
                        value: 'fXa'
                    },
                    {
                        text: 'f(Xn)',
                        sortable: false,
                        value: 'fXb'
                    },
                    {
                        text: 'Xn+1',
                        sortable: false,
                        value: 'Xc'
                    },
                    {
                        text: 'Ea',
                        sortable: false,
                        value: 'Ea'
                    }
                ],

            }),
            watch: {
                menu: function () {
                    this.limpiar()
                    switch (this.menu) {
                        case 'biseccion':
                            this.metodo = 'Bisección'
                            this.funDeXs = 'e^-x - x'
                            this.Xi = '0'
                            this.Xf = '1'
                            break
                        case 'newton':
                            this.metodo = 'Newton'
                            this.funDeXs = '2x^3 + e^x + 4'
                            this.deriF = '6x^2 + e^x'
                            this.Xn = '3'
                            break
                        case 'secante':
                            this.metodo = 'Secante'
                            this.funDeXs = 'e^-x - x'
                            this.Xi = '0'
                            this.Xf = '1'
                            break
                        default:
                            break;
                    }
                }
            },
            methods: {
                biseccion() {
                    this.evaluacion = []
                    var cont = 1
                    let a, b, m, fXi, fXf, fXm, FxifXm, eR, Xr
                    this.eR = 80
                    this.Xr = ''
                    this.a = this.Xi
                    this.b = this.Xf
                    while (this.eR > 0.01) {
                        this.m = this.puntoMedio()
                        this.fXi = this.evaluarFun(this.funDeXs, this.a)
                        this.fXm = this.evaluarFun(this.funDeXs, this.b)
                        this.fXifXm = this.evaluarXiXn()

                        if (this.fXifXm.toString() == 'NaN') {
                            this.evaluacion = []
                            this.Colorerror = 'error'
                            return
                        }

                        if (this.fXifXm > 0) {
                            this.Xr = 'a'
                            this.eR = this.errAbsoluto(this.m, this.a)
                        } else {
                            this.Xr = 'b'
                            this.eR = this.errAbsoluto(this.m, this.b)
                            this.eR = this.eR.toString().replace('-', '')
                        }

                        this.evaluacion.push({
                            numero: cont,
                            Xi: this.a,
                            Xf: this.b,
                            Xm: this.m,
                            fXi: this.funDeXs.toLowerCase().split('x').join('(' + this.a + ')') + '= ' +
                                this.fXi,
                            fXm: this.funDeXs.toLowerCase().split('x').join('(' + this.m + ')') + '= ' +
                                this.fXm,
                            fXifXm: '(' + this.fXi + ')*(' + this.fXm + ')= ' + this.fXifXm,
                            Ea: this.eR + '%'
                        })

                        this.Xr == 'a' ? this.a = this.m : this.b = this.m
                        cont++
                    }
                    // alert('El resultado fue: ' + this.m + '\ninteracciones: ' + cont)


                },
                newton() {
                    this.evaluacion = []
                    this.eR = 100
                    var cont = 0
                    let ant = 0
                    let nuevo = this.Xn
                    let x, funX, deriX, verificar
                    while (this.eR > 0.01) {
                        x = nuevo
                        this.funX = this.evaluarFun(this.funDeXs, x)
                        this.deriX = this.evaluarFun(this.deriF, x)
                        this.eR = this.errAbsoluto(nuevo, ant)

                        verificar = this.funX * this.deriX * x
                        if (verificar.toString() == 'NaN') {
                            this.evaluacion = []
                            this.Colorerror = 'error'
                            return
                        }


                        this.evaluacion.push({
                            numero: 'X' + cont,
                            X: x,
                            fX: this.funDeXs.toLowerCase().split('x').join('(' + x + ')') + '= ' +
                                this.funX,
                            fderiX: this.deriF.toLowerCase().split('x').join('(' + x + ')') + '= ' +
                                this.deriX,
                            Ea: this.eR + '%'
                        })

                        ant = x
                        nuevo = math.eval(x - (this.funX / this.deriX))

                        cont++
                    }
                },
                secante() {
                    this.evaluacion = []
                    this.eR = 100
                    var cont = 0
                    let ant = this.Xi
                    let X = this.Xf
                    let nuevo, funX, funAnt, funXc, srtXc, verificar
                    funXc = 'X1 - F(X1)*((X1 - X0)/(F(X1) - F(X0)))'
                    while (this.eR > 0.01) {
                        funX = this.evaluarFun(this.funDeXs, X)
                        funAnt = this.evaluarFun(this.funDeXs, ant)
                        srtXc = funXc
                            .split('F(X1)').join('(' + funX + ')')
                            .split('F(X0)').join('(' + funAnt + ')')
                            .split('X1').join('(' + X + ')')
                            .split('X0').join('(' + ant + ')')
                        nuevo = math.eval(srtXc)

                        this.eR = this.errAbsoluto(nuevo, X)
                        verificar = funX * funAnt * X * nuevo * ant
                        if (verificar.toString() == 'NaN') {
                            this.evaluacion = []
                            this.Colorerror = 'error'
                            return
                        }

                        this.evaluacion.push({
                            numero: 'X' + cont,
                            Xa: ant,
                            Xb: X,
                            fXa: this.funDeXs.toLowerCase().split('x').join('(' + ant + ')') + '= ' +
                                funAnt,
                            fXb: this.funDeXs.toLowerCase().split('x').join('(' + X + ')') + '= ' +
                                funX,
                            Xc: srtXc + '= ' + nuevo,
                            Ea: this.eR + '%'
                        })

                        ant = X
                        X = nuevo

                        cont++
                    }
                },
                puntoMedio() {
                    try {
                        return (parseFloat(this.a) + parseFloat(this.b)) / 2
                    } catch {
                        this.evaluacion = []
                        this.Colorerror = 'error'
                    }

                },
                evaluarFun(funcion, valor) {
                    try {
                        return math.eval(funcion.toLowerCase().split('x').join('(' + valor + ')'))
                    } catch {
                        this.evaluacion = []
                        this.Colorerror = 'error'
                    }
                },
                evaluarXiXn() {
                    try {
                        return math.eval(this.fXi * this.fXm)
                    } catch {
                        this.evaluacion = []
                        this.Colorerror = 'error'
                    }
                },
                errAbsoluto(xNew, xOld) {
                    try {
                        return math.abs(((parseFloat(xNew) - parseFloat(xOld)) / parseFloat(xNew))) * 100
                    } catch {
                        this.evaluacion = []
                        this.Colorerror = 'error'
                    }
                },

                limpiar() {
                    this.evaluacion = []
                    this.funDeXs = ''
                    this.Xi = ''
                    this.Xf = ''
                    this.deriF = ''
                    this.Xn = ''
                    this.eR = 100
                    this.Colorerror = 'info'
                }

            },
            props: {
                source: String
            }
        })
    </script>
</body>

</html>